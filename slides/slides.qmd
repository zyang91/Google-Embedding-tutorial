---
title: "Satellite and Population Embedding"
subtitle: "Powerful GeoAI Tools or Overrated?"
author:
  - name: "Zhanchao Yang"
    email: "zhanchao@upenn.edu"
    affiliations:
      - name: "University of Pennsylvania"
format:
  revealjs:
    slide-number: true
    theme:
      - serif
      - custom.scss
    transition: fade
    logo: images/logo.png
    footer: '[Github](https://github.com/zyang91/Google-Embedding-tutorial)'
editor: visual
---

## About Me

:::::: columns
::: {.column width="40%"}
![](images/Zhanchao.jpeg){top="170" left="30" width="350" height="500"}
:::

::: {.column width="3%"}
:::

::: {.column width="57%"}
### Zhanchao Yang

-   Master of City Planning (MCP)
-   Master of Urban Spatial Analytics (MUSA)
-   Bachelor of Arts in Geography, SUNY Binghamton
-   Research Assistant, Weitzman School of Design
:::
::::::

## What is Embeddings?

<br>

[In general terms, embeddings are **numerical representations** of complex information that capture the **most important features or relationships** in a simplified, machine-readable form.]{style="font-size: 1.3em;"}

## Blackbox Nature of Embeddings

-   The Embeddings generally generated through various neural network models (GNN or CNN) that trained on a large datasets.
-   The exact architecture and training process can vary widely depending on the specific application and data type.
-   The company or research institutions that developed the embeddings may not disclose the full details of their models due to proprietary or privacy reasons.

## Population Dynamics Foundation (PDFM) Embeddings

:::::: columns
::: {.column width="50%"}
-   Developed by Google Research (Google Deep Mind) in 2024.
-   Input:
    -   Census data
    -   Searching Trends
    -   Other geospatial data
-   Output:
    -   Multi-dimensional vectors (represent population characteristics and dynamics).
:::

::: {.column width="3%"}
:::

::: {.column width="47%"}
![](images/PDFM1.png){top="100" width="600" height="400"} [Trained by a Graph Neural Network (GNN) Model]{style="font-size: 0.8em;"}
:::
::::::

## How PDFM Embeddings look like?

:::::: columns
::: {.column width="50%"}
-   **330-dimensional vectors** for each census tract or ZIP code
-   Each dimension captures different aspects of population dynamics
-   Examples of captured features:
    -   Mobility patterns
    -   Search behavior trends
    -   Local economic activity
    -   Environmental conditions
:::

::: {.column width="3%"}
:::

::: {.column width="47%"}
**Key Properties:**

-   Standardized across locations
-   Privacy-preserving (aggregated data)
-   Ready for machine learning models
-   Can be used for similarity analysis
:::
::::::

## Applications of PDFM Embeddings

:::::: columns
::: {.column width="50%"}
**Health & Social Services:**

-   Disease prevalence prediction
-   Public health risk assessment
-   Healthcare resource allocation

**Economic Analysis:**

-   Socioeconomic indicators modeling
-   Income and poverty estimation
-   Economic development planning
:::

::: {.column width="3%"}
:::

::: {.column width="47%"}
**Business & Retail:**

-   Store location optimization
-   Market demand forecasting
-   Customer segmentation

**Marketing & Sales:**

-   Identifying high-performance regions
-   Finding similar market areas
-   Campaign targeting
:::
::::::

## Demo 1: Using PDFM Embeddings to predict housing prices

:::::: columns
::: {.column width="50%"}
**Dataset:**

-   Zillow Home Value Index (ZHVI) by ZIP code
-   PDFM embeddings (330 features)
-   Inner join on ZIP code

**Model:**

-   Linear Regression
-   Input: 330 embedding features
-   Output: Predicted home prices
:::

::: {.column width="3%"}
:::

::: {.column width="47%"}
**Why it works:**

-   Embeddings capture:
    -   Zip code/County level characteristics
    -   Economic activity patterns
    -   Demographics signals
-   No need for manual feature engineering
:::
::::::

## Satellite Foundation Model (SFM) Embeddings

:::::: columns
::: {.column width="50%"}
-   Developed by Google Research
-   Based on Sentinel-2 satellite imagery
-   **Global coverage** (2017-2023)
-   Spatial resolution: 10 meters
-   Available through Google Earth Engine
:::

::: {.column width="3%"}
:::

::: {.column width="47%"}
**What they capture:**

-   Land cover patterns
-   Vegetation characteristics
-   Urban development
-   Environmental changes
-   Temporal dynamics

[Trained on massive satellite imagery corpus using self-supervised learning]{style="font-size: 0.9em;"}
:::
::::::

## Satellite Embeddings with Google Earth Engine (GEE)

**Dataset:**

-   `GOOGLE/SATELLITE_EMBEDDING/V1/ANNUAL`
-   65 bands

**Key Operations:**

-   Filter by date and location
-   Extract embeddings for points/regions
-   Compare temporal changes
-   Calculate similarity (dot product)


## Applications of SFM Embeddings

**Environmental and Land Use Planning**

-   Urban sprawl analysis
-   Land cover classification
-   Change detection
-   Development planning

**Temporal Analysis:**

-   Seasonal pattern detection
-   Long-term trend analysis
-   Before/after comparisons
-   Similarity searches across time


## Demo 2: Satellite Embeddings for Land Cover Classification

**Approach:**

-   Use embeddings as features
-   Train classification model
-   Predict land cover types

**Advantages:**

-   No need to process raw imagery
-   Pre-trained representations
-   Faster than traditional methods

## Workflow

1.  Define area of interest
2.  Load embedding ImageCollection
3.  Extract features for labeled samples
4.  Train classifier (Random Forest, SVM)
5.  Apply to entire region
6.  Validate results

[Uses Earth Engine's cloud computing for scalability]{style="font-size: 0.9em;"}


## Limitations and Concerns

**Interpretability Issues:**

-   Black box representations
-   Limited transparency in training process

**Bias and Fairness:**

-   May encode historical biases
-   Risk of perpetuating spatial inequalities


**Technical Limitations:**

-   Resolution constraints (10m for satellite)
-   Updates not in real-time

...

## Summary and Conclusions

**The Promise:**

-   Powerful tools for spatial analysis
-   Capture complex patterns (Privacy concerns)

**The Reality:**

-   Require careful validation
-   Complement, not replace

**Best Practices:**

-   Validate predictions thoroughly
-   Be aware of limitations and biases

## Final Verdict
[Powerful GeoAI tools, but use with caution and critical thinking!]{style="font-size: 1.1em; font-weight: bold;"}


## References

::: {style="font-size: 0.8em;"}
**Google Research:**

-   Google PDFM Embeddings: [github.com/google-research/population-dynamics](https://github.com/google-research/population-dynamics)
-   Satellite Embeddings Dataset: [developers.google.com/earth-engine/datasets/catalog/GOOGLE_SATELLITE_EMBEDDING_V1_ANNUAL](https://developers.google.com/earth-engine/datasets/catalog/GOOGLE_SATELLITE_EMBEDDING_V1_ANNUAL)

**Tutorials & Resources:**

-   Dr. Qiusheng Wu PDFM Tutorial: [github.com/opengeos/GeoAI-Tutorials](https://github.com/opengeos/GeoAI-Tutorials)
-   Dr. Qiusheng Wu Earth Embedding Tutorial: [leafmap.org/maplibre/AlphaEarth](https://leafmap.org/maplibre/AlphaEarth)
-   Google Earth Engine Tutorial: [developers.google.com/earth-engine/tutorials/community/satellite-embedding-02-unsupervised-classification](https://developers.google.com/earth-engine/tutorials/community/satellite-embedding-02-unsupervised-classification)

**This Presentation:**

-   GitHub Repository: [github.com/zyang91/Google-Embedding-tutorial](https://github.com/zyang91/Google-Embedding-tutorial)
:::
